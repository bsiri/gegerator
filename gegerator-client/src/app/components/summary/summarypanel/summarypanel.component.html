
<div class="summary-panel">

    <mat-tab-group [dynamicHeight]="true">

        <mat-tab label="Roadmap">
            <div class="pane">
                <h1>Roadmap :</h1>
                <div class="pane-content">
                    <div *ngFor="let day of Days.enumerate()">
                        <ul>
                            <li *ngFor="let event of roadmap.dailyPlanning().get(day)">
                                <app-event-link [event]="event">
                                    {{event.toString()}}
                                </app-event-link>
                            </li>
                            <li *ngIf="roadmap.dailyPlanning().get(day)?.length == 0">
                                {{'('+day.name+' : Rien)'}}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </mat-tab>

        <mat-tab label="Films">
            <div class="pane">
                <h1>Récap des films :</h1>
                <div class="pane-content">
                    <table>
                        <tbody>
                            <tr *ngFor="let movie of movies$ | async | orderByComparable:'rating':'title'">
                                <td>
                                    <app-movie-ratings [rating]="movie.rating"></app-movie-ratings>
                                </td>
                                <td>
                                    <span>{{movie.title}} </span>
                                    <ng-container [ngTemplateOutlet]="movieSessionLink" 
                                            [ngTemplateOutletContext]="{session:getSession(movie)}">
                                    </ng-container>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <!--                         
                    <div *ngFor="let entry of moviesForRatings$ | async | orderByComparable:'rating'">
                        <h2>{{entry.rating.description}} :</h2>
                        <ul>
                            <li *ngFor="let movie of entry.movies | orderByLowercase:'title'">
                                <span>{{movie.title}} </span> 
                                <ng-container [ngTemplateOutlet]="movieSessionLink" 
                                            [ngTemplateOutletContext]="{session:getSession(movie)}">
                                </ng-container>
                            </li>
                            <li *ngIf="entry.movies.length == 0">(Aucun)</li>
                        </ul> 
                    </div>
                    -->
                </div>
            </div>
        </mat-tab>

        <mat-tab label="Sessions">
            <div class="pane">
                <h1>Récap des sessions :</h1>
                <div class="pane-content">
                    <div *ngFor="let entry of sessionsForRatings$ | async | orderByComparable:'rating'">
                        <ng-container *ngIf="entry.rating.key != 'DEFAULT'">
                        <h2>{{entry.rating.description}} :</h2>
                        <ul>
                            <li *ngFor="let session of entry.sessions | orderByComparable:'day':'startTime'">
                                <app-event-link [event]="session">
                                    {{session.toString()}}
                                </app-event-link>
                            </li>
                            <li *ngIf="entry.sessions.length == 0">(Aucun)</li>
                        </ul>
                        </ng-container>
                    </div>
                </div>
            </div>
        </mat-tab>


    </mat-tab-group>

</div>

<!-- Templates -->

<ng-template #movieSessionLink  let-session="session">
    <app-event-link *ngIf="session" [event]="session">
        {{session.format('(%d, %h, %t)')}}
    </app-event-link>
    <span *ngIf="! session">(non planifié)</span>
</ng-template>